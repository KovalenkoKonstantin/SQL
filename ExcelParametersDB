select top 100 *
from
    Sales.Orders
where OrderDate between '20130101' and '20130110'
order by OrderDate;

--удаление таблицы
drop table NewOne;

--создание таблицы на основе существующей
select * into dbo.NewOne
from sales.Orders
go
select * from dbo.NewOne;

-- создание нового столбца в существующей таблице
ALTER TABLE NewOne ADD DeliveryCityID int;

--удаление столбца из существующей таблицы
alter table NewOne drop column DeliveryCityID;

--заполнение нового столбца на основе совпадения CustomerID в обеих таблицах
update NewOne
set NewOne.DeliveryCityID = c.DeliveryCityID
from Sales.Customers c
    where NewOne.CustomerID = c.CustomerID;

ALTER TABLE NewOne ADD StateProvinceID int;
ALTER TABLE NewOne ADD StateProvinceName varchar(30);

--заполнение нового столбца на основе совпадения DeliveryCityID в обеих таблицах
update NewOne
set NewOne.StateProvinceID = a.StateProvinceID
from Application.Cities a
where NewOne.DeliveryCityID = a.CityID;

--заполнение нового столбца на основе совпадения StateProvinceID в обеих таблицах
update NewOne
set NewOne.StateProvinceName = p.StateProvinceName
from Application.StateProvinces p
where NewOne.StateProvinceID = p.StateProvinceID;

select * from newone;
