drop table if exists Enterprise;
drop procedure if exists EnterpriseCreation;
create procedure EnterpriseCreation as
begin
    create table Enterprise
    (
        organization_id  int
            constraint FK_Enterprise_organization_id
                references Organization,
        goz_attribute_id int
            constraint FK_Enterprise_goz_attribute_id
                references GozAttribute,
        project_id       int
            constraint FK_Enterprise_project_id
                references Project,
        year_id          int
            constraint FK_Enterprise_year_id
                references Year (year_id),
        expenditures_id  int
            constraint FK_Enterprise_expenditures_id
                references Expenditures,
        enterprise_value float
    )
    drop procedure if exists EnterpriseInsertion;
    create procedure EnterpriseInsertion as
    begin
        insert into Enterprise(organization_id, goz_attribute_id, project_id, year_id, expenditures_id,
                               enterprise_value)
        values (3, 1, 1083, 21, 1, 0.00),
               (3, 1, 1083, 21, 2, 0.00),
               (3, 1, 1083, 21, 3, 1471494690.39),
               (3, 1, 1083, 21, 4, 118842421.92),
               (3, 1, 1083, 21, 5, 386623809.49),
               (3, 1, 1083, 21, 6, 0.00),
               (3, 1, 1083, 21, 7, 0.00),
               (3, 1, 1083, 21, 8, 1945235188.76),
               (3, 1, 1083, 21, 9, 2988164800.52),
               (3, 1, 1083, 21, 10, 1744687908.07),
               (3, 1, 1083, 21, 11, 4732852708.59),
               (3, 1, 1083, 21, 12, 554862784.71),
               (3, 1, 1083, 21, 13, 5287715493.30),
               (3, 1, 1083, 21, 14, 8117.92),
               (3, 1, 1083, 21, 15, 873.00),
               (3, 1, 1083, 21, 16, 109414438.80),
               (3, 1, 1083, 21, 17, 56268.00),
               (3, 1, 1083, 21, 18, 26657676.75),
               (3, 1, 1083, 21, 19, 932408269.93),
               (3, 1, 1083, 21, 20, 177914293.67),
               (3, 1, 1083, 21, 21, 36939455.75),
               (3, 1, 1083, 21, 22, 6091988.92),
               (3, 1, 1083, 21, 23, 0.00),
               (3, 1, 1083, 21, 24, 15050227.24),
               (3, 1, 1083, 21, 25, 0.00),
               (3, 1, 1083, 21, 26, 371669.68),
               (3, 1, 1083, 21, 27, 640330900.02),
               (3, 1, 1083, 21, 28, 0.00),
               (3, 1, 1083, 21, 29, 53813821.81),
               (3, 1, 1083, 21, 30, 186378610.33),
               (3, 1, 1083, 21, 31, 28807207.47),
               (3, 1, 1083, 21, 32, 3773896.97),
               (3, 1, 1083, 21, 33, 36881050.29),
               (3, 1, 1083, 21, 34, 951638.31),
               (3, 1, 1083, 21, 35, 1687549.12),
               (3, 1, 1083, 21, 36, 613.35),
               (3, 1, 1083, 21, 37, 0.00),
               (3, 1, 1083, 21, 38, 0.00),
               (3, 1, 1083, 21, 39, 7291891.97),
               (3, 1, 1083, 21, 40, 0.00),
               (3, 1, 1083, 21, 41, 59825866.02),
               (3, 1, 1083, 21, 42, 0.00),
               (3, 1, 1083, 21, 43, 1413424.04),
               (3, 1, 1083, 21, 44, 16919015.30),
               (3, 1, 1083, 21, 45, 11291959.83),
               (3, 1, 1083, 21, 46, 74523848.48),
               (3, 1, 1083, 21, 47, 86769.38),
               (3, 1, 1083, 21, 48, 83457623.15),
               (3, 1, 1083, 21, 49, 5409695.32),
               (3, 1, 1083, 21, 50, 498851.61),
               (3, 1, 1083, 21, 51, 22512208.91),
               (3, 1, 1083, 21, 52, 5237212.71),
               (3, 1, 1083, 21, 53, 39568145.65),
               (3, 1, 1083, 21, 54, 4732852708.59),
               (3, 1, 1083, 21, 55, 1744687908.07),
               (3, 1, 1083, 21, 56, -134964962.03),
               (3, 1, 1083, 21, 57, 1990425845.09),
               (3, 1, 1083, 21, 58, 2022760687.81),
               (3, 1, 1083, 21, 59, 2988164800.52),
               (3, 1, 1083, 21, 60, 250.00),
               (3, 1, 1083, 21, 61, 895392440.55),
               (3, 1, 1083, 21, 62, 37015829.38),
               (3, 1, 1083, 21, 63, 177914293.67),
               (3, 1, 1083, 22, 1, 0.00),
               (3, 1, 1083, 22, 2, 0.00),
               (3, 1, 1083, 22, 3, 1862785321.38),
               (3, 1, 1083, 22, 4, 152160052.19),
               (3, 1, 1083, 22, 5, 94166225.79),
               (3, 1, 1083, 22, 6, 0.00),
               (3, 1, 1083, 22, 7, 0.00),
               (3, 1, 1083, 22, 8, 1699834090.92),
               (3, 1, 1083, 22, 9, 2898973141.43),
               (3, 1, 1083, 22, 10, 2961205516.54),
               (3, 1, 1083, 22, 11, 5860178657.97),
               (3, 1, 1083, 22, 12, 697072178.12),
               (3, 1, 1083, 22, 13, 6557250836.09),
               (3, 1, 1083, 22, 14, 9367.97),
               (3, 1, 1083, 22, 15, 1003.00),
               (3, 1, 1083, 22, 16, 151424503.47),
               (3, 1, 1083, 22, 17, 184504.88),
               (3, 1, 1083, 22, 18, 17984101.20),
               (3, 1, 1083, 22, 19, 976828292.47),
               (3, 1, 1083, 22, 20, 27460927.09),
               (3, 1, 1083, 22, 21, 47352019.22),
               (3, 1, 1083, 22, 22, 3972059.36),
               (3, 1, 1083, 22, 23, 0.00),
               (3, 1, 1083, 22, 24, 25103476.22),
               (3, 1, 1083, 22, 25, 0.00),
               (3, 1, 1083, 22, 26, 334308.02),
               (3, 1, 1083, 22, 27, 449189898.99),
               (3, 1, 1083, 22, 28, 0.00),
               (3, 1, 1083, 22, 29, 40277806.87),
               (3, 1, 1083, 22, 30, 67413750.67),
               (3, 1, 1083, 22, 31, 16525433.66),
               (3, 1, 1083, 22, 32, 6017397.34),
               (3, 1, 1083, 22, 33, 46533520.02),
               (3, 1, 1083, 22, 34, 988167.54),
               (3, 1, 1083, 22, 35, 109034.10),
               (3, 1, 1083, 22, 36, 11123.50),
               (3, 1, 1083, 22, 37, 0.00),
               (3, 1, 1083, 22, 38, 8042.90),
               (3, 1, 1083, 22, 39, 6733507.15),
               (3, 1, 1083, 22, 40, 0.00),
               (3, 1, 1083, 22, 41, 108209762.44),
               (3, 1, 1083, 22, 42, 64080.00),
               (3, 1, 1083, 22, 43, 304765.50),
               (3, 1, 1083, 22, 44, 16102618.19),
               (3, 1, 1083, 22, 45, 14631945.51),
               (3, 1, 1083, 22, 46, 30144750.86),
               (3, 1, 1083, 22, 47, 62561.89),
               (3, 1, 1083, 22, 48, 31948250.23),
               (3, 1, 1083, 22, 49, 2771596.52),
               (3, 1, 1083, 22, 50, 0.00),
               (3, 1, 1083, 22, 51, 28411791.17),
               (3, 1, 1083, 22, 52, 975554.38),
               (3, 1, 1083, 22, 53, 30944438.55),
               (3, 1, 1083, 22, 54, 5860178657.97),
               (3, 1, 1083, 22, 55, 2961205516.54),
               (3, 1, 1083, 22, 56, 1153910576.41),
               (3, 1, 1083, 22, 57, 711555988.26),
               (3, 1, 1083, 22, 58, 681374756.25),
               (3, 1, 1083, 22, 59, 2898973141.43),
               (3, 1, 1083, 22, 60, 271.00),
               (3, 1, 1083, 22, 61, 930253892.14),
               (3, 1, 1083, 22, 62, 46574400.33),
               (3, 1, 1083, 22, 63, 27460927.09),
               (3, 1, 1083, 23, 1, 0.00),
               (3, 1, 1083, 23, 2, 0.00),
               (3, 1, 1083, 23, 3, 3161791350.00),
               (3, 1, 1083, 23, 4, 213024073.07),
               (3, 1, 1083, 23, 5, 131832716.11),
               (3, 1, 1083, 23, 6, 0.00),
               (3, 1, 1083, 23, 7, 0.00),
               (3, 1, 1083, 23, 8, 2379767567.85),
               (3, 1, 1083, 23, 9, 4058562398.00),
               (3, 1, 1083, 23, 10, 4145687723.16),
               (3, 1, 1083, 23, 11, 8204250121.16),
               (3, 1, 1083, 23, 12, 975901049.37),
               (3, 1, 1083, 23, 13, 9180151170.53),
               (3, 1, 1083, 23, 14, 12204.80),
               (3, 1, 1083, 23, 15, 1307.00),
               (3, 1, 1083, 23, 16, 211994304.86),
               (3, 1, 1083, 23, 17, 258306.83),
               (3, 1, 1083, 23, 18, 25177741.68),
               (3, 1, 1083, 23, 19, 1367559450.00),
               (3, 1, 1083, 23, 20, 38445297.93),
               (3, 1, 1083, 23, 21, 66292826.91),
               (3, 1, 1083, 23, 22, 5560883.10),
               (3, 1, 1083, 23, 23, 0.00),
               (3, 1, 1083, 23, 24, 35144866.71),
               (3, 1, 1083, 23, 25, 0.00),
               (3, 1, 1083, 23, 26, 468031.23),
               (3, 1, 1083, 23, 27, 628865858.60),
               (3, 1, 1083, 23, 28, 0.00),
               (3, 1, 1083, 23, 29, 56388929.62),
               (3, 1, 1083, 23, 30, 94379250.94),
               (3, 1, 1083, 23, 31, 23135607.12),
               (3, 1, 1083, 23, 32, 8424356.28),
               (3, 1, 1083, 23, 33, 65146928.03),
               (3, 1, 1083, 23, 34, 1383434.56),
               (3, 1, 1083, 23, 35, 152647.74),
               (3, 1, 1083, 23, 36, 15572.90),
               (3, 1, 1083, 23, 37, 0.00),
               (3, 1, 1083, 23, 38, 11260.06),
               (3, 1, 1083, 23, 39, 9426910.01),
               (3, 1, 1083, 23, 40, 0.00),
               (3, 1, 1083, 23, 41, 151493667.42),
               (3, 1, 1083, 23, 42, 89712.00),
               (3, 1, 1083, 23, 43, 426671.70),
               (3, 1, 1083, 23, 44, 22543665.47),
               (3, 1, 1083, 23, 45, 20484723.71),
               (3, 1, 1083, 23, 46, 42202651.20),
               (3, 1, 1083, 23, 47, 87586.65),
               (3, 1, 1083, 23, 48, 44727550.32),
               (3, 1, 1083, 23, 49, 3880235.13),
               (3, 1, 1083, 23, 50, 0.00),
               (3, 1, 1083, 23, 51, 39776507.64),
               (3, 1, 1083, 23, 52, 1365776.13),
               (3, 1, 1083, 23, 53, 43322213.97),
               (3, 1, 1083, 23, 54, 8204250121.16),
               (3, 1, 1083, 23, 55, 4145687723.16),
               (3, 1, 1083, 23, 56, 1615474806.97),
               (3, 1, 1083, 23, 57, 996178383.56),
               (3, 1, 1083, 23, 58, 953924658.75),
               (3, 1, 1083, 23, 59, 4058562398.00),
               (3, 1, 1083, 23, 60, 379.00),
               (3, 1, 1083, 23, 61, 1302355450.00),
               (3, 1, 1083, 23, 62, 65204000.00),
               (3, 1, 1083, 23, 63, 38445297.93),
               (3, 1, 1083, 24, 1, 0.00),
               (3, 1, 1083, 24, 2, 0.00),
               (3, 1, 1083, 24, 3, 3477970000.00),
               (3, 1, 1083, 24, 4, 234326480.38),
               (3, 1, 1083, 24, 5, 145015987.72),
               (3, 1, 1083, 24, 6, 0.00),
               (3, 1, 1083, 24, 7, 0.00),
               (3, 1, 1083, 24, 8, 2617743929.17),
               (3, 1, 1083, 24, 9, 4464418637.80),
               (3, 1, 1083, 24, 10, 4560256495.48),
               (3, 1, 1083, 24, 11, 9024675133.28),
               (3, 1, 1083, 24, 12, 1073491154.31),
               (3, 1, 1083, 24, 13, 10098166287.59),
               (3, 1, 1083, 24, 14, 13425.00),
               (3, 1, 1083, 24, 15, 1438.00),
               (3, 1, 1083, 24, 16, 233193735.35),
               (3, 1, 1083, 24, 17, 284137.51),
               (3, 1, 1083, 24, 18, 27695515.85),
               (3, 1, 1083, 24, 19, 1504315000.00),
               (3, 1, 1083, 24, 20, 42289827.72),
               (3, 1, 1083, 24, 21, 72922109.60),
               (3, 1, 1083, 24, 22, 6116971.41),
               (3, 1, 1083, 24, 23, 0.00),
               (3, 1, 1083, 24, 24, 38659353.38),
               (3, 1, 1083, 24, 25, 0.00),
               (3, 1, 1083, 24, 26, 514834.35),
               (3, 1, 1083, 24, 27, 691752444.00),
               (3, 1, 1083, 24, 28, 0.00),
               (3, 1, 1083, 24, 29, 62027823.00),
               (3, 1, 1083, 24, 30, 103817176.00),
               (3, 1, 1083, 24, 31, 25449168.00),
               (3, 1, 1083, 24, 32, 9266792.00),
               (3, 1, 1083, 24, 33, 71661621.00),
               (3, 1, 1083, 24, 34, 1521778.00),
               (3, 1, 1083, 24, 35, 167913.00),
               (3, 1, 1083, 24, 36, 17130.00),
               (3, 1, 1083, 24, 37, 0.00),
               (3, 1, 1083, 24, 38, 12386.00),
               (3, 1, 1083, 24, 39, 10369601.00),
               (3, 1, 1083, 24, 40, 0.00),
               (3, 1, 1083, 24, 41, 166643034.00),
               (3, 1, 1083, 24, 42, 98683.00),
               (3, 1, 1083, 24, 43, 469339.00),
               (3, 1, 1083, 24, 44, 24798032.00),
               (3, 1, 1083, 24, 45, 22533196.00),
               (3, 1, 1083, 24, 46, 46422916.00),
               (3, 1, 1083, 24, 47, 96345.00),
               (3, 1, 1083, 24, 48, 49200305.00),
               (3, 1, 1083, 24, 49, 4268259.00),
               (3, 1, 1083, 24, 50, 0.00),
               (3, 1, 1083, 24, 51, 43754158.00),
               (3, 1, 1083, 24, 52, 1502354.00),
               (3, 1, 1083, 24, 53, 47654435.00),
               (3, 1, 1083, 24, 54, 9024675133.28),
               (3, 1, 1083, 24, 55, 4560256495.48),
               (3, 1, 1083, 24, 56, 1777022287.67),
               (3, 1, 1083, 24, 57, 1095796221.92),
               (3, 1, 1083, 24, 58, 1049317124.63),
               (3, 1, 1083, 24, 59, 4464418637.80),
               (3, 1, 1083, 24, 60, 417.00),
               (3, 1, 1083, 24, 61, 1432591000.00),
               (3, 1, 1083, 24, 62, 71724000.00),
               (3, 1, 1083, 24, 63, 42289827.72);
    end;
        drop table if exists Enterprise;
        exec EnterpriseCreation;
        exec EnterpriseInsertion;

    select *
    from Enterprise;

    select year_number, expenditures_name, enterprise_value
    from Enterprise
             inner join Expenditures E on Enterprise.expenditures_id = E.expenditures_id
             inner join Year Y on Enterprise.year_id = Y.year_id;

        drop procedure if exists GetEnterpriseRefresh;
        create procedure GetEnterpriseRefresh
        as
        begin
            --prevent the "1 row affected" message from being returned for every operation
            set nocount on
--statement for the procedure
            select year_number, expenditures_name, enterprise_value
            from Enterprise
                     inner join Expenditures E on Enterprise.expenditures_id = E.expenditures_id
                     inner join Year Y on Enterprise.year_id = Y.year_id;
        end
            drop procedure if exists EnterpriseInsertion;

            execute EnterpriseCreation;
end;
go

exec GetEnterpriseRefresh;